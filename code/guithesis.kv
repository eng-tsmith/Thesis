<ScreenManagement>:
    ScreenMain:
    ScreenSettingsTraining:
    ScreenSettingsRealtime:


<ScreenMain>:
    name: 'screen_main'
    BoxLayout:
        orientation: "vertical"
        canvas:
            Color:
                rgb: 1, 1, 1
            Rectangle:
                source: 'gui/LoadingScreen.png'
                size: self.size
        Label:
            text: "[b]Master Thesis[/b] \n Autonomous Driving"
            markup: True
            halign: 'center'
            size_hint: 1, .1
            font_size: '20sp'
        Label:
            size_hint: 1, .3
        Button:
            text: "Train Network"
            size_hint: 1, .05
            halign: 'center'
            on_press:
                root.manager.transition.direction = 'right'
                root.manager.transition.duration = 1
                root.manager.current = 'screen_settings_training'
        Button:
            text: "Real-Time Mode"
            size_hint: 1, .05
            halign: 'center'
            on_press:
                root.manager.transition.direction = 'left'
                root.manager.transition.duration = 1
                root.manager.current = 'screen_settings_realtime'
        Button:
            text: "Exit"
            size_hint: 1, .05
            halign: 'center'
            on_press: app.stop()
        Label:
            size_hint: 1, .1

<ScreenSettingsTraining>:
    name: 'screen_settings_training'
    BoxLayout:
        orientation: "vertical"
        Label:
            text: "[b]Settings[/b] \n Neural Network Training"
            markup: True
            halign: 'left'
            size_hint: 1, .25
            font_size: '20sp'
        BoxLayout:
            orientation: "vertical"
            BoxLayout:
                orientation: "horizontal"
                Label:
                    size_hint: 1, .1
                Label:
                    text: 'Data directory:'
                    halign: 'right'
                TextInput:
                    id: text_path
                    text: 'rec_data'
                Label:
                    size_hint: 1, .1
            BoxLayout:
                orientation: "horizontal"
                Label:
                    size_hint: 1, .1
                Label:
                    text: 'Test size fraction:'
                    halign: 'right'
                TextInput:
                    id: text_test_frac
                    text: '0.2'
                Label:
                    size_hint: 1, .1
            BoxLayout:
                orientation: "horizontal"
                Label:
                    size_hint: 1, .1
                Label:
                    text: 'Drop out probability:'
                    halign: 'right'
                TextInput:
                    id: text_dropout_pos
                    text: '0.5'
                Label:
                    size_hint: 1, .1
            BoxLayout:
                orientation: "horizontal"
                Label:
                    size_hint: 1, .1
                Label:
                    text: 'Number of epochs:'
                    halign: 'right'
                TextInput:
                    id: text_nr_epochs
                    text: '10'
                Label:
                    size_hint: 1, .1
            BoxLayout:
                orientation: "horizontal"
                Label:
                    size_hint: 1, .1
                Label:
                    text: 'Samples per epoch:'
                    halign: 'right'
                TextInput:
                    id: text_samples_per_epoch
                    text: '20000'
                Label:
                    size_hint: 1, .1
            BoxLayout:
                orientation: "horizontal"
                Label:
                    size_hint: 1, .1
                Label:
                    text: 'Batch size:'
                    halign: 'right'
                TextInput:
                    id: text_batch_size
                    text: '40'
                Label:
                    size_hint: 1, .1
            BoxLayout:
                orientation: "horizontal"
                Label:
                    size_hint: 1, .1
                Label:
                    text: 'Save best models only:'
                    halign: 'right'
                TextInput:
                    id: text_best_models_only
                    text: 'true'
                Label:
                    size_hint: 1, .1
            BoxLayout:
                orientation: "horizontal"
                Label:
                    size_hint: 1, .1
                Label:
                    text: 'Learning rate:'
                    halign: 'right'
                TextInput:
                    id: text_lr
                    text: '1.0e-4'
                Label:
                    size_hint: 1, .1
            BoxLayout:
                orientation: "horizontal"
                Label:
                    size_hint: 1, .1
                Label:
                    text: 'Experiment:'
                    halign: 'right'
                TextInput:
                    id: text_exp
                    text: 'Experiment Name'
                Label:
                    size_hint: 1, .1
        BoxLayout:
            size_hint: 1, .25
            orientation: "horizontal"
            Label:
                size_hint: 0.1, .8
            MyButton:
                id: my_button_train
                text: "Go"
                size_hint: 0.3, .8
                on_press: my_button_train.text = "Already Running..."
                on_press: app.train_ext([text_path.text, text_test_frac.text, text_dropout_pos.text, text_nr_epochs.text, text_samples_per_epoch.text, text_batch_size.text, text_best_models_only.text, text_lr.text, text_exp.text])
            Button:
                text: "Back"
                size_hint: 0.3, .8
                on_press:
                    root.manager.transition.direction = 'left'
                    root.manager.transition.duration = 1
                    root.manager.current = 'screen_main'
            Button:
                text: "Exit"
                size_hint: 0.3, .8
                on_press: app.stop()
            Label:
                size_hint: 0.1, .8
        Label:
            size_hint: 1, .1

<ScreenSettingsRealtime>:
    name: 'screen_settings_realtime'
    BoxLayout:
        orientation: "vertical"
        Label:
            text: "[b]Models[/b] \n Choose model for real-time autonomous driving"
            markup: True
            halign: 'left'
            size_hint: 1, .25
            font_size: '20sp'
        FileChooserListView:
            id: file_chooser
            path: app.local_path
        BoxLayout:
            size_hint: 1, .25
            orientation: "horizontal"
            Label:
                size_hint: 0.1, .8
            MyButton:
                id: my_button_realtime
                text: "Go"
                size_hint: 0.3, .8
                on_press: my_button_realtime.enabled = False
                on_press: my_button_realtime.text = "Already Running..."
                on_press: app.realtime_ext(file_chooser.path, file_chooser.selection)
            Button:
                text: "Back"
                size_hint: 0.3, .8
                on_press:
                    root.manager.transition.direction = 'right'
                    root.manager.transition.duration = 1
                    root.manager.current = 'screen_main'
            Button:
                text: "Exit"
                size_hint: 0.3, .8
                on_press: app.stop()
            Label:
                size_hint: 0.1, .8
        Label:
            size_hint: 1, .1